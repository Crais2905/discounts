2025-03-18 21:00:48,669 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:00:52,784 - celery.worker.consumer.consumer - ERROR - consumer: Cannot connect to redis://localhost:6379/0: Error 10061 connecting to localhost:6379. No connection could be made because the target machine actively refused it..
Trying again in 2.00 seconds... (1/100)

2025-03-18 21:00:58,893 - celery.worker.consumer.consumer - ERROR - consumer: Cannot connect to redis://localhost:6379/0: Error 10061 connecting to localhost:6379. No connection could be made because the target machine actively refused it..
Trying again in 4.00 seconds... (2/100)

2025-03-18 21:01:06,991 - celery.worker.consumer.consumer - ERROR - consumer: Cannot connect to redis://localhost:6379/0: Error 10061 connecting to localhost:6379. No connection could be made because the target machine actively refused it..
Trying again in 6.00 seconds... (3/100)

2025-03-18 21:02:37,079 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:02:41,185 - celery.worker.consumer.consumer - ERROR - consumer: Cannot connect to redis://localhost:6379/0: Error 10061 connecting to localhost:6379. No connection could be made because the target machine actively refused it..
Trying again in 2.00 seconds... (1/100)

2025-03-18 21:03:50,378 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:03:50,407 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:06:58,450 - celery.beat - INFO - beat: Starting...
2025-03-18 21:07:08,539 - celery.beat - INFO - Scheduler: Sending due task test (celery_app.test)
2025-03-18 21:07:08,570 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'celery_app.test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'celery_app.test', 'id': '26768ba7-0630-4fb3-b670-eed648a9d062', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '26768ba7-0630-4fb3-b670-eed648a9d062', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen18376@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'celery_app.test'
2025-03-18 21:07:18,515 - celery.beat - INFO - Scheduler: Sending due task test (celery_app.test)
2025-03-18 21:07:18,519 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'celery_app.test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'celery_app.test', 'id': 'e4ca2dcc-4755-4d5f-bff8-fb7e35d77df2', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'e4ca2dcc-4755-4d5f-bff8-fb7e35d77df2', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen18376@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'celery_app.test'
2025-03-18 21:07:28,515 - celery.beat - INFO - Scheduler: Sending due task test (celery_app.test)
2025-03-18 21:07:28,519 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'celery_app.test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'celery_app.test', 'id': '265cbe0e-bbad-4ed5-8338-1676dfc68485', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '265cbe0e-bbad-4ed5-8338-1676dfc68485', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen18376@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'celery_app.test'
2025-03-18 21:07:38,516 - celery.beat - INFO - Scheduler: Sending due task test (celery_app.test)
2025-03-18 21:07:38,520 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'celery_app.test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'celery_app.test', 'id': '5f75bdf3-19be-469e-b413-04f895832e13', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '5f75bdf3-19be-469e-b413-04f895832e13', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen18376@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'celery_app.test'
2025-03-18 21:07:48,517 - celery.beat - INFO - Scheduler: Sending due task test (celery_app.test)
2025-03-18 21:07:48,521 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'celery_app.test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'celery_app.test', 'id': 'a515c665-f6c1-4d7e-b701-a76b64bc336c', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'a515c665-f6c1-4d7e-b701-a76b64bc336c', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen18376@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'celery_app.test'
2025-03-18 21:07:58,518 - celery.beat - INFO - Scheduler: Sending due task test (celery_app.test)
2025-03-18 21:07:58,521 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'celery_app.test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'celery_app.test', 'id': 'de20b202-a94e-4bfd-b04d-9a011bd96973', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'de20b202-a94e-4bfd-b04d-9a011bd96973', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen18376@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'celery_app.test'
2025-03-18 21:08:08,518 - celery.beat - INFO - Scheduler: Sending due task test (celery_app.test)
2025-03-18 21:08:08,521 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'celery_app.test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'celery_app.test', 'id': 'd64a0e58-cad4-4f77-ab3e-0dd6c042a203', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'd64a0e58-cad4-4f77-ab3e-0dd6c042a203', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen18376@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'celery_app.test'
2025-03-18 21:10:25,552 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:10:25,582 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:10:40,008 - celery.beat - INFO - beat: Starting...
2025-03-18 21:10:40,043 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:10:40,057 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test', 'id': 'b502557b-bcd8-4a2e-9b82-d40048a7d26c', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'b502557b-bcd8-4a2e-9b82-d40048a7d26c', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen31740@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test'
2025-03-18 21:10:50,029 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:10:50,033 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test', 'id': '9fe93155-b91c-4e45-99ab-06b32b248acf', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '9fe93155-b91c-4e45-99ab-06b32b248acf', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen31740@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test'
2025-03-18 21:11:00,029 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:11:00,034 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test', 'id': 'da503e25-b62d-4889-9def-1d5bda4f7763', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'da503e25-b62d-4889-9def-1d5bda4f7763', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen31740@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test'
2025-03-18 21:11:10,029 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:11:10,035 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test', 'id': '7f72f9c5-b237-4975-b67c-509ba20dcfd7', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '7f72f9c5-b237-4975-b67c-509ba20dcfd7', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen31740@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test'
2025-03-18 21:14:53,829 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:14:53,858 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:15:02,489 - celery.beat - INFO - beat: Starting...
2025-03-18 21:15:02,519 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:15:02,535 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': 'b32387cc-b984-48b1-9b5d-5f6d2f67d6a1', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'b32387cc-b984-48b1-9b5d-5f6d2f67d6a1', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:15:12,508 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:15:12,513 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': '7e4b5314-f340-46df-8143-27f50f1a7f36', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '7e4b5314-f340-46df-8143-27f50f1a7f36', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:15:22,508 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:15:22,513 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': '25628800-68d4-45c6-ac07-2476a378164c', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '25628800-68d4-45c6-ac07-2476a378164c', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:15:32,509 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:15:32,513 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': '040cee3b-0e52-4cef-bcff-bca66a711fbb', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '040cee3b-0e52-4cef-bcff-bca66a711fbb', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:15:42,510 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:15:42,514 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': '61d1ff72-b3be-4cf8-9d56-95e83fbd3547', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '61d1ff72-b3be-4cf8-9d56-95e83fbd3547', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:15:52,511 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:15:52,514 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': '6a814d1a-a8d8-4de1-885e-968cabd7a344', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '6a814d1a-a8d8-4de1-885e-968cabd7a344', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:16:02,512 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:16:02,516 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': '4e0b7980-e640-440a-9076-eb1c5ad9e289', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '4e0b7980-e640-440a-9076-eb1c5ad9e289', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:16:12,512 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:16:12,516 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': 'c42bc405-0833-41f5-8374-51b35276f89c', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'c42bc405-0833-41f5-8374-51b35276f89c', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:16:22,512 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.task)
2025-03-18 21:16:22,516 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.task'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.task', 'id': 'e727de90-e5d4-457d-81e5-5510a1df49dd', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'e727de90-e5d4-457d-81e5-5510a1df49dd', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen872@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.task'
2025-03-18 21:16:45,985 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:16:46,049 - py.warnings - WARNING - C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-18 21:16:50,657 - celery.beat - INFO - beat: Starting...
2025-03-18 21:16:50,693 - celery.beat - INFO - Scheduler: Sending due task test (server.parse_data.tasks.test)
2025-03-18 21:16:50,707 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'server.parse_data.tasks.test'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'server.parse_data.tasks.test', 'id': '98a092b0-41f3-4c94-aa4a-080a72df0401', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '98a092b0-41f3-4c94-aa4a-080a72df0401', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen19176@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'server.parse_data.tasks.test'
2025-03-18 21:20:46,642 - celery.beat - INFO - beat: Starting...
2025-03-18 21:20:46,692 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:20:56,673 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:21:06,674 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:21:16,675 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:21:26,676 - celery.beat - INFO - Scheduler: Sending due task test (test)
2025-03-18 21:23:49,060 - celery.beat - INFO - beat: Starting...
2025-03-18 21:23:49,098 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-18 21:23:59,082 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-18 21:24:09,082 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 22:37:28,973 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 22:37:29,571 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 22:40:55,152 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 22:40:55,266 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 22:41:20,931 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '6e0e56d4-3450-4895-b628-0d8b1f60a492', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '6e0e56d4-3450-4895-b628-0d8b1f60a492', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen12988@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 22:41:30,894 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'e4205759-f5d6-454b-97b4-e645fe9eee83', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'e4205759-f5d6-454b-97b4-e645fe9eee83', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen12988@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 22:41:40,896 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '3fc3cb40-c886-45df-b8df-e15846f380cc', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '3fc3cb40-c886-45df-b8df-e15846f380cc', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen12988@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 22:42:28,920 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 22:42:28,981 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:42:28,991 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 22:42:28,993 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 22:42:28,994 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 22:42:28,997 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 115, in __enter__
    return self._semlock.__enter__()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:42:28,999 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 22:42:29,000 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:42:29,001 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:42:29,002 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 22:42:29,003 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 22:42:29,003 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 22:42:29,004 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:42:29,005 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:42:29,007 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:42:29,008 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 22:42:29,009 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:42:29,010 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 22:42:29,011 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 22:42:29,014 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:42:29,015 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:42:29,016 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 22:42:29,017 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 22:42:29,018 - celery.redirected - WARNING - Call stack:
2025-03-19 22:42:29,020 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 22:42:29,021 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 22:42:29,022 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 22:42:29,023 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 22:42:29,024 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 22:42:29,025 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 22:42:29,026 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 22:42:29,028 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x00000299C9F49110>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 22:42:29,030 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 22:42:29,032 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:42:29,032 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 22:42:29,035 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 22:42:29,035 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 22:42:29,037 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 115, in __enter__
    return self._semlock.__enter__()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:42:29,038 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 22:42:29,038 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:42:29,040 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:42:29,041 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 22:42:29,042 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 22:42:29,043 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 22:42:29,043 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:42:29,045 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:42:29,047 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:42:29,049 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 22:42:29,051 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:42:29,052 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 22:42:29,053 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 22:42:29,054 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:42:29,055 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:42:29,057 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 22:42:29,058 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 22:42:29,059 - celery.redirected - WARNING - Call stack:
2025-03-19 22:42:29,061 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 22:42:29,063 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 22:42:29,065 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 22:42:29,066 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 22:42:29,067 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 22:42:29,068 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 22:42:29,069 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 22:42:29,070 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x00000299C9F49110>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 22:45:15,246 - celery.beat - INFO - beat: Starting...
2025-03-19 22:45:15,287 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 22:45:15,307 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'eab55d73-d5b2-4bee-a312-ae3bdd992200', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'eab55d73-d5b2-4bee-a312-ae3bdd992200', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen38756@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 22:45:25,268 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 22:45:25,273 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '33d9b8d5-da5e-4779-8445-19a44a5e81b9', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '33d9b8d5-da5e-4779-8445-19a44a5e81b9', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen38756@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 22:46:00,694 - celery.beat - INFO - beat: Starting...
2025-03-19 22:46:00,750 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 22:46:00,770 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'ffb21dbf-363e-445d-a43a-f52a52f5ea9b', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'ffb21dbf-363e-445d-a43a-f52a52f5ea9b', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen36988@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 22:49:04,409 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 22:49:04,502 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 22:49:09,641 - celery.beat - INFO - beat: Starting...
2025-03-19 22:49:09,679 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 22:49:09,743 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '365b4187-ef36-42f1-8dde-f4bff492034f', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '365b4187-ef36-42f1-8dde-f4bff492034f', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen37952@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 22:50:55,329 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 22:50:55,336 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:50:55,340 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 22:50:55,343 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 22:50:55,346 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 22:50:55,349 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:50:55,352 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 22:50:55,355 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:50:55,358 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:50:55,362 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 22:50:55,365 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 22:50:55,368 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 22:50:55,371 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:50:55,373 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:50:55,376 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:50:55,379 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 22:50:55,382 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:50:55,385 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 22:50:55,388 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 22:50:55,392 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:50:55,395 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:50:55,398 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 22:50:55,401 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 22:50:55,404 - celery.redirected - WARNING - Call stack:
2025-03-19 22:50:55,408 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 22:50:55,411 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 22:50:55,414 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 22:50:55,417 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 22:50:55,420 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 22:50:55,423 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 22:50:55,426 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 22:50:55,429 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000025FBFB99210>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 22:50:55,432 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 22:50:55,436 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:50:55,439 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 22:50:55,442 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 22:50:55,445 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 22:50:55,448 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:50:55,450 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 22:50:55,452 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:50:55,453 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:50:55,454 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 22:50:55,456 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 22:50:55,457 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 22:50:55,459 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:50:55,460 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:50:55,462 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:50:55,463 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 22:50:55,464 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 22:50:55,467 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 22:50:55,470 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 22:50:55,473 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 22:50:55,476 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 22:50:55,478 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 22:50:55,483 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 22:50:55,486 - celery.redirected - WARNING - Call stack:
2025-03-19 22:50:55,490 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 22:50:55,493 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 22:50:55,496 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 22:50:55,499 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 22:50:55,502 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 22:50:55,505 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 22:50:55,508 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 22:50:55,512 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000025FBFB99210>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:01:43,648 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 23:01:43,780 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 23:01:48,026 - celery.beat - INFO - beat: Starting...
2025-03-19 23:01:48,121 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:01:48,142 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'f54a73e5-9f7d-4c3f-ad0d-8eecfcba62b2', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'f54a73e5-9f7d-4c3f-ad0d-8eecfcba62b2', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen1896@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:01:58,064 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:01:58,068 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'e39ec40a-e025-48e5-ba47-095f45250197', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'e39ec40a-e025-48e5-ba47-095f45250197', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen1896@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:02:08,065 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:02:08,069 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '879b506a-60ad-4399-b396-ee598a1df5fa', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '879b506a-60ad-4399-b396-ee598a1df5fa', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen1896@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:02:18,065 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:02:18,072 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'dd9e073a-fb67-4cbf-a269-0e7b5fdab9bb', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'dd9e073a-fb67-4cbf-a269-0e7b5fdab9bb', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen1896@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:02:28,066 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:02:28,070 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '918e7e8d-2b9f-4981-895e-3041ce722628', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '918e7e8d-2b9f-4981-895e-3041ce722628', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen1896@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:02:38,066 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:02:38,070 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'a9ccefc1-001b-40e9-bbce-e5ec16590b8f', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'a9ccefc1-001b-40e9-bbce-e5ec16590b8f', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen1896@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:02:48,067 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:02:48,071 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'c874b047-3bc1-4abd-9fcb-1b27453035d5', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'c874b047-3bc1-4abd-9fcb-1b27453035d5', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen1896@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:03:07,424 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 23:03:07,470 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 23:03:11,099 - celery.beat - INFO - beat: Starting...
2025-03-19 23:03:11,155 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:03:11,175 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'c5579f1c-61a5-449a-a376-3391ecf0a5f2', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'c5579f1c-61a5-449a-a376-3391ecf0a5f2', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:03:21,127 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:03:21,131 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '80b6ee3e-c67c-4a92-8419-ea14429dd99f', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '80b6ee3e-c67c-4a92-8419-ea14429dd99f', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:03:31,128 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:03:31,132 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '1ceb076e-2153-4086-af03-38f65fb1d799', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '1ceb076e-2153-4086-af03-38f65fb1d799', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:03:41,128 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:03:41,133 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '4bed6543-ee85-4b90-9c42-6a7f16decfb6', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '4bed6543-ee85-4b90-9c42-6a7f16decfb6', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:03:51,128 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:03:51,133 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '59604cac-f847-415c-85ee-7b06a9e7313a', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '59604cac-f847-415c-85ee-7b06a9e7313a', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:04:01,129 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:04:01,134 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '1ef137aa-8101-493e-aee0-478c903c1bc8', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '1ef137aa-8101-493e-aee0-478c903c1bc8', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:04:11,129 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:04:11,133 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '0a3a4cfd-021f-47aa-b78a-aec6aab3c6c7', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '0a3a4cfd-021f-47aa-b78a-aec6aab3c6c7', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:04:21,129 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:04:21,134 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '3f06e4ea-9d1d-4368-bdba-10f58dbe2f87', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '3f06e4ea-9d1d-4368-bdba-10f58dbe2f87', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:04:31,129 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:04:41,130 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:04:51,130 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:05:01,131 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:05:37,779 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:05:37,783 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:05:37,789 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,794 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,796 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:05:37,797 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:05:37,798 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:05:37,799 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:05:37,800 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:05:37,801 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:05:37,801 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 115, in __enter__
    return self._semlock.__enter__()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,804 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,804 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 23:05:37,807 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:05:37,809 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,808 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,812 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,815 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,817 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:05:37,819 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:05:37,822 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:05:37,823 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:05:37,825 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:05:37,829 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:05:37,830 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,832 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,832 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,835 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,836 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,840 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:05:37,840 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,843 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,843 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:05:37,845 - celery.redirected - WARNING -   File "<string>", line 3, in getvalue
2025-03-19 23:05:37,845 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,847 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 23:05:37,847 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:05:37,849 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,852 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,852 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,854 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,854 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:05:37,856 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:05:37,859 - celery.redirected - WARNING - Call stack:
2025-03-19 23:05:37,859 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:05:37,860 - celery.redirected - WARNING - Call stack:
2025-03-19 23:05:37,860 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:05:37,861 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:05:37,861 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:05:37,862 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:05:37,862 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:05:37,864 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:05:37,864 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:05:37,865 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:05:37,865 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:05:37,866 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:05:37,866 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:05:37,867 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:05:37,867 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:05:37,868 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:05:37,869 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000015424E38DD0>, PermissionError(13, 'Access is denied', None, 5, None))
2025-03-19 23:05:37,870 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000002300FCE8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:05:37,872 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:05:37,875 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,875 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,876 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:05:37,876 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:05:37,877 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:05:37,878 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:05:37,879 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:05:37,879 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:05:37,880 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 115, in __enter__
    return self._semlock.__enter__()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,881 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,881 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 23:05:37,882 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:05:37,882 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,883 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,883 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,883 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,884 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:05:37,884 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:05:37,885 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:05:37,886 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:05:37,887 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:05:37,887 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:05:37,888 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,891 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,890 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,892 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,894 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:05:37,893 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,895 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,895 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,896 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:05:37,897 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:05:37,897 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:05:37,899 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:05:37,899 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,900 - celery.redirected - WARNING -   File "<string>", line 3, in getvalue
2025-03-19 23:05:37,900 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,901 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 23:05:37,901 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:05:37,902 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:05:37,903 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:05:37,903 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:05:37,904 - celery.redirected - WARNING - Call stack:
2025-03-19 23:05:37,904 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:05:37,906 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:05:37,907 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:05:37,908 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:05:37,909 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:05:37,909 - celery.redirected - WARNING - Call stack:
2025-03-19 23:05:37,910 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:05:37,910 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:05:37,911 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:05:37,912 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:05:37,913 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:05:37,913 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:05:37,914 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:05:37,914 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:05:37,916 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:05:37,915 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000002300FCE8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:05:37,917 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:05:37,918 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:05:37,919 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000015424E38DD0>, PermissionError(13, 'Access is denied', None, 5, None))
2025-03-19 23:05:48,723 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 23:05:48,874 - py.warnings - WARNING - d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

2025-03-19 23:05:50,112 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '92d94667-c904-4f2e-a828-67ff7c7db754', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '92d94667-c904-4f2e-a828-67ff7c7db754', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:05:50,123 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '227d8e6d-5d80-4607-a2fb-88f42333f39d', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '227d8e6d-5d80-4607-a2fb-88f42333f39d', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:05:50,132 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'f5488250-fd28-421a-bfe7-a59a6caedb55', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'f5488250-fd28-421a-bfe7-a59a6caedb55', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen28368@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:05:53,104 - celery.beat - INFO - beat: Starting...
2025-03-19 23:06:03,131 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:06:03,151 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'e9b2bed2-f178-429b-9c0b-fd2badd8101d', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'e9b2bed2-f178-429b-9c0b-fd2badd8101d', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen42476@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:06:13,117 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:06:13,120 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': 'ecb259d6-d0db-4e22-ab64-03a03dd2712b', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'ecb259d6-d0db-4e22-ab64-03a03dd2712b', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen42476@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:06:23,118 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:06:23,121 - celery.worker.consumer.consumer - ERROR - Received unregistered task of type 'test_func'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': 'test_func', 'id': '01f08ac1-75c3-4909-80f0-059f113f10a5', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '01f08ac1-75c3-4909-80f0-059f113f10a5', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen42476@DESKTOP-IO01P69', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
               ~~~~~~~~~~^^^^^^^
KeyError: 'test_func'
2025-03-19 23:06:33,118 - celery.beat - INFO - Scheduler: Sending due task test (test_func)
2025-03-19 23:38:01,058 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,114 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,124 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,106 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,155 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,153 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,161 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,177 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,181 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,160 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,159 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,199 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,199 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,216 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,184 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,217 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,218 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,220 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,222 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,222 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,226 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,184 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,225 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,226 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,241 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,253 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,253 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,253 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,256 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,256 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,257 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,271 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,257 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,272 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,289 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,272 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,289 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,300 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,304 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,305 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,306 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,318 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,322 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,335 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,343 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,285 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,350 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,352 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,333 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,349 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,358 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,358 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,360 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,368 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,378 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,374 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,389 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,389 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:01,391 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,392 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,403 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,407 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:01,351 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,353 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,410 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,408 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:01,412 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,411 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,412 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:01,384 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:01,414 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,416 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,427 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,438 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:01,412 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,444 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:01,447 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:01,447 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:01,449 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:01,447 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,449 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,452 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:01,454 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,367 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,466 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,467 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,467 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:01,439 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:01,441 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,472 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:01,472 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:01,477 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,478 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,483 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:01,475 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,494 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:01,494 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,495 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,496 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:01,495 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:01,498 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,498 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,499 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:01,499 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,500 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:01,506 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:01,506 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,507 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:01,509 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001C796448DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:01,510 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:01,508 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,509 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,524 - celery.redirected - WARNING - --- Logging error ---
call last):
2025-03-19 23:38:01,469 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,524 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:01,533 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:01,533 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,535 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:01,554 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
illiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,562 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,576 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:01,576 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,578 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,579 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:01,591 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,592 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,592 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:01,594 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,594 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,521 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,594 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:01,597 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,608 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:01,499 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:01,610 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:01,609 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,611 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:01,625 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:01,540 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,638 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:01,653 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000002F45B0D8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:01,562 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:01,667 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,670 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,672 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,675 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,654 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,611 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:01,667 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:01,678 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,692 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:01,688 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,693 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:01,694 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,706 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,707 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:01,596 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,709 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,710 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:01,710 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,725 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,725 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,725 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:01,725 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000002216BAA8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:01,741 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:01,742 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,741 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,739 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,739 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,746 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,746 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,760 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,760 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,773 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,744 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:01,773 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,774 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,774 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,774 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,791 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,615 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,791 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,791 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,804 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,804 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:01,805 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,804 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,807 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,807 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,485 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,811 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,815 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:01,820 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,820 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,823 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,823 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,835 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,836 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,841 - celery.redirected - WARNING -   File "<string>", line 3, in getvalue
2025-03-19 23:38:01,849 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:01,708 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,862 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 23:38:01,862 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:01,862 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,864 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,865 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:01,865 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,867 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,783 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,880 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,880 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:01,881 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:01,882 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,895 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:01,896 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,705 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,897 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:01,898 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,824 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,900 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:01,900 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,900 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,902 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,848 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:01,902 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,916 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,916 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,849 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,918 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:01,932 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:01,918 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,945 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,946 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:01,777 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001E5BAEC9110>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:01,803 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,948 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:01,948 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,962 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,948 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,963 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,964 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,964 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,972 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:01,978 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,978 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:01,961 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,987 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:01,992 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:01,993 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:01,994 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,995 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:01,995 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:01,882 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,009 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:01,994 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,883 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:01,918 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,011 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,012 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:01,962 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,014 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:01,899 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,960 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:01,902 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,015 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,014 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,030 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,029 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,032 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,044 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,058 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,053 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,059 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,043 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:01,905 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,074 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,074 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,075 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,075 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,089 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,089 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,012 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
, another exception occurred:
2025-03-19 23:38:02,102 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,004 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,118 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,118 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,073 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,009 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,121 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,121 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,029 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,089 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,123 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,091 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,124 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,126 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,125 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,125 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,125 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,141 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,141 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,012 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,142 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,143 - celery.redirected - WARNING - Call stack:
ограмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,088 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,142 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,145 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,143 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,146 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,144 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,146 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,153 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,160 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,146 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,147 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001C796448DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,160 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,162 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,163 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,164 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,164 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,165 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,161 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,163 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,166 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,166 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x00000285DCC19110>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,167 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,167 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,169 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,180 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,118 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000021D25059110>, PermissionError(13, 'Access is denied', None, 5, None))
2025-03-19 23:38:02,181 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,009 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,181 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,182 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,182 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,183 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,184 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000002216BAA8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,184 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,185 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,183 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,089 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,174 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,188 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,183 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,121 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,188 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,189 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,121 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,125 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,188 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,191 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,194 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,195 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,196 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,198 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,198 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,196 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,200 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,202 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,203 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,203 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,202 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,204 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,121 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,205 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,205 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,209 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,210 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,207 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,203 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,212 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,212 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,205 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,225 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,225 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,209 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,207 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,228 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,227 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,228 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,195 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,230 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,230 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,229 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,230 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,231 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,232 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,233 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,245 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,246 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,247 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,247 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,247 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,246 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,247 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,247 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,251 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,251 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,251 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,252 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,253 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,254 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,254 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,251 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,255 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,255 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,255 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,259 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,262 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,269 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,271 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,269 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,285 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,284 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,285 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,286 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,295 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,290 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,271 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,303 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,301 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,305 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,314 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,316 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,316 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,316 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,316 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,315 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,316 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,317 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,331 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,331 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,332 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,318 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,345 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,332 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,345 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,345 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,346 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,348 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,223 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,348 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,348 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,348 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,352 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,348 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,225 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,363 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,364 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,363 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,378 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,363 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,378 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,378 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,378 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,380 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,380 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,380 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,196 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,382 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,382 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,382 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000002218AE59010>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,382 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,383 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,382 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,388 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,385 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,399 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,398 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,320 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,332 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,408 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,408 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,361 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,362 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,423 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,425 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,425 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,425 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,425 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,439 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,431 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,440 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,441 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,440 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,441 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,442 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,447 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,403 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,448 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,457 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,457 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,457 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,469 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,473 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,485 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,200 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,456 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,485 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,500 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,500 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,509 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,513 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,405 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,515 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,515 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,516 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,516 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,530 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,530 - celery.redirected - WARNING - Traceback (most recent call last):
e>
2025-03-19 23:38:02,529 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,544 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,553 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,363 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,516 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,557 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,565 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,571 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,571 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,571 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,584 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,584 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,582 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,585 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,587 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,584 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,471 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,587 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,456 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,592 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000016DCB4F9010>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,491 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,602 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,487 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,603 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,604 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,457 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,601 - celery.redirected - WARNING -   File "<string>", line 3, in getvalue
2025-03-19 23:38:02,605 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,618 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,618 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 23:38:02,618 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,593 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,604 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,629 - celery.redirected - WARNING -   File "<string>", line 3, in getvalue
2025-03-19 23:38:02,631 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,628 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,631 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,634 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,631 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,533 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001B505CB8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,644 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,645 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,644 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 23:38:02,647 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,645 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,645 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,658 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,662 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,662 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,662 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,662 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,555 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,662 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,677 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,677 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,677 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,677 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,677 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,677 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,678 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,678 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,599 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,679 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,680 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,681 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,682 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,682 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,681 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,682 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,684 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,604 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,684 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,683 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,685 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,684 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,685 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,686 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,687 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,687 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,700 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,687 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,700 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,701 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,689 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,701 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,702 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x00000248C1B89210>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,702 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,701 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,715 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,715 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,715 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,715 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,715 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,715 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,717 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,718 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,718 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,732 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,726 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,732 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001E5BAEC9110>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,733 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,743 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,735 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,732 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,745 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,747 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,745 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,747 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,746 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,748 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x00000285DCC19110>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,750 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,751 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000002F45B0D8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,750 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,749 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,751 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,752 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,751 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,753 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,754 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,754 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,755 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,754 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000015446C69210>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,754 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,768 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,768 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,769 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,770 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,769 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,770 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,771 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
iard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,773 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,775 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,778 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,773 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,778 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,780 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,780 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000027CF1CA9210>, PermissionError(13, 'Access is denied', None, 5, None))
2025-03-19 23:38:02,782 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,783 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,792 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,795 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,796 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,795 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,796 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,795 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,798 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,799 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,799 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,800 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,800 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,800 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,804 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,813 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,813 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,814 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,814 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,815 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,815 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,815 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,604 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,815 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,816 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,829 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,830 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,831 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,831 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,832 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,844 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,845 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,779 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,847 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,814 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,848 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,848 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,848 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:02,815 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:02,851 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,851 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,851 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,866 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,866 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,866 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,823 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,831 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,866 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,877 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,880 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,880 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,880 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,881 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:02,882 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,882 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,883 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:02,842 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,880 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,898 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,898 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,912 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,912 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,588 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:02,912 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,912 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,866 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,925 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,925 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,927 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000021D25059110>, PermissionError(13, 'Access is denied', None, 5, None))
2025-03-19 23:38:02,927 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,927 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,928 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,940 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:02,928 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,928 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:02,943 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,943 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:02,881 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,898 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,953 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:02,957 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:02,971 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,971 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,956 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:02,972 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:02,972 - celery.redirected - WARNING - Call stack:
ограмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,973 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,898 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:02,973 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:02,974 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,974 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,974 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,975 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:02,975 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:02,975 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:02,975 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:02,975 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000002218AE59010>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:02,957 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:02,980 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:02,983 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:02,990 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:02,990 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:02,990 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:03,010 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001FC28849310>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:03,004 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:03,004 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:03,004 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:03,000 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:03,004 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,030 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,030 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:03,031 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,049 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:03,049 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:03,030 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,054 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:03,054 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:03,055 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:03,055 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,057 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:03,057 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:03,057 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:03,059 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:03,072 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:03,072 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:03,072 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,088 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:03,093 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:03,109 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:03,045 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:03,113 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:03,030 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:03,113 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:03,114 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:03,115 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,115 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:03,115 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,117 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:03,004 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,118 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000016DCB4F9010>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:03,118 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 473, in receive
    ready, req = _receive(1.0)
                 ^^^^^^^^^^^^^
2025-03-19 23:38:03,119 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:03,119 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,059 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001B505CB8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:03,120 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:03,121 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:03,121 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,122 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:03,121 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 445, in _recv
    return True, loads(get_payload())
                       ^^^^^^^^^^^^^
2025-03-19 23:38:03,123 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:03,123 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:03,125 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:03,124 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\queues.py", line 394, in get_payload
    with self._rlock:
2025-03-19 23:38:03,124 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,125 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,085 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,127 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x00000248C1B89210>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:03,127 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\synchronize.py", line 118, in __exit__
    return self._semlock.__exit__(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,127 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,128 - celery.redirected - WARNING -   File "<string>", line 3, in getvalue
2025-03-19 23:38:03,128 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,129 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:03,130 - celery.redirected - WARNING - PermissionError: [WinError 5] Access is denied
2025-03-19 23:38:03,130 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:03,131 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,132 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,132 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,130 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,134 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,135 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,135 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:03,135 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:03,137 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 351, in workloop
    req = wait_for_job()
          ^^^^^^^^^^^^^^
2025-03-19 23:38:03,138 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:03,138 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,139 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,139 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 480, in receive
    raise SystemExit(EX_FAILURE)
2025-03-19 23:38:03,140 - celery.redirected - WARNING -   File "<string>", line 7, in getvalue
2025-03-19 23:38:03,141 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:03,142 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:03,144 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:03,145 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,138 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:03,146 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:03,146 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,148 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:03,147 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:03,148 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:03,142 - celery.redirected - WARNING - SystemExit: 1
2025-03-19 23:38:03,151 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:03,151 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:03,151 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,151 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,153 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:03,153 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:03,154 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,156 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:03,156 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:03,157 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
             ^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,156 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:03,157 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:03,158 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 396, in workloop
    self._ensure_messages_consumed(completed=completed)
2025-03-19 23:38:03,158 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:03,160 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000027CF1CA9210>, PermissionError(13, 'Access is denied', None, 5, None))
2025-03-19 23:38:03,161 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:03,161 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:03,161 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 406, in _ensure_messages_consumed
    if self.on_ready_counter.value >= completed:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,164 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x0000015446C69210>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:03,164 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:03,166 - celery.redirected - WARNING - OSError: [WinError 6] The handle is invalid
2025-03-19 23:38:03,166 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:03,168 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,170 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:03,171 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,172 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:03,172 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:03,174 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001DC1FAE8DD0>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:03,174 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,177 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:03,180 - celery.redirected - WARNING -   File "<string>", line 1, in <module>
2025-03-19 23:38:03,182 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 164, in spawn_main
    exitcode = _main(fd)
2025-03-19 23:38:03,184 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\spawn.py", line 209, in _main
    return self._bootstrap()
2025-03-19 23:38:03,187 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 323, in _bootstrap
    self.run()
2025-03-19 23:38:03,188 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 110, in run
    self._target(*self._args, **self._kwargs)
2025-03-19 23:38:03,190 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 294, in __call__
    error('Pool process %r error: %r', self, exc, exc_info=1)
2025-03-19 23:38:03,193 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 139, in error
    util.get_logger().error(msg, *args, **kwargs)
2025-03-19 23:38:03,194 - celery.redirected - WARNING - Message: 'Pool process %r error: %r'
Arguments: (<billiard.pool.Worker object at 0x000001FC28849310>, OSError(9, 'The handle is invalid', None, 6, None))
2025-03-19 23:38:03,311 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:03,314 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:03,323 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,325 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 202, in start
    self.blueprint.start(self)
2025-03-19 23:38:03,326 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,328 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
2025-03-19 23:38:03,329 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 202, in start
    self.blueprint.start(self)
2025-03-19 23:38:03,330 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           ^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,333 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 340, in start
    blueprint.start(self)
2025-03-19 23:38:03,332 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
2025-03-19 23:38:03,335 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
2025-03-19 23:38:03,335 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           ^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,336 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 746, in start
    c.loop(*c.loop_args())
2025-03-19 23:38:03,338 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\loops.py", line 123, in synloop
    state.maybe_shutdown()
2025-03-19 23:38:03,338 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 340, in start
    blueprint.start(self)
2025-03-19 23:38:03,340 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
2025-03-19 23:38:03,340 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
2025-03-19 23:38:03,342 - celery.redirected - WARNING - celery.exceptions.WorkerShutdown: 1
2025-03-19 23:38:03,342 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 746, in start
    c.loop(*c.loop_args())
2025-03-19 23:38:03,344 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,345 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\loops.py", line 123, in synloop
    state.maybe_shutdown()
2025-03-19 23:38:03,345 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,347 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
2025-03-19 23:38:03,347 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 148, in send_all
    fun(parent, *args)
2025-03-19 23:38:03,349 - celery.redirected - WARNING - celery.exceptions.WorkerShutdown: 1
2025-03-19 23:38:03,349 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 369, in stop
    return self.obj.stop()
           ^^^^^^^^^^^^^^^
2025-03-19 23:38:03,351 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,351 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\concurrency\base.py", line 121, in stop
    self.on_stop()
2025-03-19 23:38:03,353 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,353 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\concurrency\prefork.py", line 143, in on_stop
    self._pool.join()
2025-03-19 23:38:03,355 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 148, in send_all
    fun(parent, *args)
2025-03-19 23:38:03,355 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 1625, in join
    p.join()
2025-03-19 23:38:03,357 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 369, in stop
    return self.obj.stop()
           ^^^^^^^^^^^^^^^
2025-03-19 23:38:03,357 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 144, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,358 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\concurrency\base.py", line 121, in stop
    self.on_stop()
2025-03-19 23:38:03,360 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\concurrency\prefork.py", line 143, in on_stop
    self._pool.join()
2025-03-19 23:38:03,359 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\popen_spawn_win32.py", line 103, in wait
    res = _winapi.WaitForSingleObject(int(self._handle), msecs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,361 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 1625, in join
    p.join()
2025-03-19 23:38:03,362 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\apps\worker.py", line 289, in _handle_request
    safe_say(f'worker: {how} shutdown (MainProcess)', sys.__stdout__)
2025-03-19 23:38:03,363 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 144, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,364 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\apps\worker.py", line 81, in safe_say
    print(f'\n{msg}', file=f, flush=True)
2025-03-19 23:38:03,365 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\popen_spawn_win32.py", line 103, in wait
    res = _winapi.WaitForSingleObject(int(self._handle), msecs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-03-19 23:38:03,365 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,367 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,367 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\apps\worker.py", line 289, in _handle_request
    safe_say(f'worker: {how} shutdown (MainProcess)', sys.__stdout__)
2025-03-19 23:38:03,369 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,370 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\apps\worker.py", line 81, in safe_say
    print(f'\n{msg}', file=f, flush=True)
2025-03-19 23:38:03,370 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:03,372 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,372 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,374 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:03,374 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:03,377 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:03,377 - celery.redirected - WARNING -   File "<frozen runpy>", line 198, in _run_module_as_main
2025-03-19 23:38:03,379 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:03,379 - celery.redirected - WARNING -   File "<frozen runpy>", line 88, in _run_code
2025-03-19 23:38:03,381 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,381 - celery.redirected - WARNING -   File "D:\Програмування\FastAPI\discounts\.venv\Scripts\celery.exe\__main__.py", line 7, in <module>
    sys.exit(main())
2025-03-19 23:38:03,384 - celery.redirected - WARNING -   File "<frozen runpy>", line 198, in _run_module_as_main
2025-03-19 23:38:03,383 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\__main__.py", line 15, in main
    sys.exit(_main())
2025-03-19 23:38:03,385 - celery.redirected - WARNING -   File "<frozen runpy>", line 88, in _run_code
2025-03-19 23:38:03,385 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bin\celery.py", line 236, in main
    return celery(auto_envvar_prefix="CELERY")
2025-03-19 23:38:03,386 - celery.redirected - WARNING -   File "D:\Програмування\FastAPI\discounts\.venv\Scripts\celery.exe\__main__.py", line 7, in <module>
    sys.exit(main())
2025-03-19 23:38:03,387 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1161, in __call__
    return self.main(*args, **kwargs)
2025-03-19 23:38:03,387 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\__main__.py", line 15, in main
    sys.exit(_main())
2025-03-19 23:38:03,389 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bin\celery.py", line 236, in main
    return celery(auto_envvar_prefix="CELERY")
2025-03-19 23:38:03,389 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1082, in main
    rv = self.invoke(ctx)
2025-03-19 23:38:03,390 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1161, in __call__
    return self.main(*args, **kwargs)
2025-03-19 23:38:03,390 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1697, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
2025-03-19 23:38:03,392 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1082, in main
    rv = self.invoke(ctx)
2025-03-19 23:38:03,392 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1443, in invoke
    return ctx.invoke(self.callback, **ctx.params)
2025-03-19 23:38:03,393 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1697, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
2025-03-19 23:38:03,393 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 788, in invoke
    return __callback(*args, **kwargs)
2025-03-19 23:38:03,395 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1443, in invoke
    return ctx.invoke(self.callback, **ctx.params)
2025-03-19 23:38:03,395 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
2025-03-19 23:38:03,397 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 788, in invoke
    return __callback(*args, **kwargs)

2025-03-19 23:38:03,398 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
2025-03-19 23:38:03,398 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
2025-03-19 23:38:03,400 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
2025-03-19 23:38:03,400 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 209, in start
    self.stop(exitcode=exc.code)
2025-03-19 23:38:03,401 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
2025-03-19 23:38:03,401 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 250, in stop
    self._shutdown(warm=True)
2025-03-19 23:38:03,403 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 209, in start
    self.stop(exitcode=exc.code)
2025-03-19 23:38:03,403 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 265, in _shutdown
    self.blueprint.stop(self, terminate=not warm)
2025-03-19 23:38:03,404 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 250, in stop
    self._shutdown(warm=True)
2025-03-19 23:38:03,405 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 168, in stop
    self.restart(
2025-03-19 23:38:03,405 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 265, in _shutdown
    self.blueprint.stop(self, terminate=not warm)
2025-03-19 23:38:03,406 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 135, in restart
    self.send_all(parent, method, description, propagate=propagate)
2025-03-19 23:38:03,407 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 168, in stop
    self.restart(
2025-03-19 23:38:03,409 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 152, in send_all
    logger.exception(
2025-03-19 23:38:03,410 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 135, in restart
    self.send_all(parent, method, description, propagate=propagate)
2025-03-19 23:38:03,410 - celery.redirected - WARNING - Message: 'Error on %s %s: %r'
Arguments: ('stopping', 'Pool', OSError(22, 'No process is on the other end of the pipe', None, 233, None))
2025-03-19 23:38:03,202 - celery.bootsteps - ERROR - Error on stopping Pool: OSError(22, 'No process is on the other end of the pipe', None, 233, None)
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 202, in start
    self.blueprint.start(self)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           ^^^^^^^^^^^^^^^^
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 340, in start
    blueprint.start(self)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 746, in start
    c.loop(*c.loop_args())
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\loops.py", line 123, in synloop
    state.maybe_shutdown()
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
celery.exceptions.WorkerShutdown: 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 148, in send_all
    fun(parent, *args)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 369, in stop
    return self.obj.stop()
           ^^^^^^^^^^^^^^^
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\concurrency\base.py", line 121, in stop
    self.on_stop()
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\concurrency\prefork.py", line 143, in on_stop
    self._pool.join()
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 1625, in join
    p.join()
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 144, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\popen_spawn_win32.py", line 103, in wait
    res = _winapi.WaitForSingleObject(int(self._handle), msecs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\apps\worker.py", line 289, in _handle_request
    safe_say(f'worker: {how} shutdown (MainProcess)', sys.__stdout__)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\apps\worker.py", line 81, in safe_say
    print(f'\n{msg}', file=f, flush=True)
OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:03,412 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 152, in send_all
    logger.exception(
2025-03-19 23:38:03,414 - celery.redirected - WARNING - Message: 'Error on %s %s: %r'
Arguments: ('stopping', 'Pool', OSError(22, 'No process is on the other end of the pipe', None, 233, None))
2025-03-19 23:38:03,218 - celery.bootsteps - ERROR - Error on stopping Pool: OSError(22, 'No process is on the other end of the pipe', None, 233, None)
Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 202, in start
    self.blueprint.start(self)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           ^^^^^^^^^^^^^^^^
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 340, in start
    blueprint.start(self)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 746, in start
    c.loop(*c.loop_args())
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\loops.py", line 123, in synloop
    state.maybe_shutdown()
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
celery.exceptions.WorkerShutdown: 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 148, in send_all
    fun(parent, *args)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 369, in stop
    return self.obj.stop()
           ^^^^^^^^^^^^^^^
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\concurrency\base.py", line 121, in stop
    self.on_stop()
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\concurrency\prefork.py", line 143, in on_stop
    self._pool.join()
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\pool.py", line 1625, in join
    p.join()
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\process.py", line 144, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\billiard\popen_spawn_win32.py", line 103, in wait
    res = _winapi.WaitForSingleObject(int(self._handle), msecs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\apps\worker.py", line 289, in _handle_request
    safe_say(f'worker: {how} shutdown (MainProcess)', sys.__stdout__)
  File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\apps\worker.py", line 81, in safe_say
    print(f'\n{msg}', file=f, flush=True)
OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:04,017 - celery.redirected - WARNING - --- Logging error ---
2025-03-19 23:38:04,136 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:04,138 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 202, in start
    self.blueprint.start(self)
2025-03-19 23:38:04,140 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
2025-03-19 23:38:04,142 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           ^^^^^^^^^^^^^^^^
2025-03-19 23:38:04,143 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 340, in start
    blueprint.start(self)
2025-03-19 23:38:04,144 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
2025-03-19 23:38:04,145 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 746, in start
    c.loop(*c.loop_args())
2025-03-19 23:38:04,147 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\loops.py", line 123, in synloop
    state.maybe_shutdown()
2025-03-19 23:38:04,148 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
2025-03-19 23:38:04,151 - celery.redirected - WARNING - celery.exceptions.WorkerShutdown: 1
2025-03-19 23:38:04,153 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:04,155 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:04,156 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\transport\virtual\base.py", line 1012, in _deliver
    callback = self._callbacks[queue]
               ~~~~~~~~~~~~~~~^^^^^^^
2025-03-19 23:38:04,157 - celery.redirected - WARNING - KeyError: 'celery'
2025-03-19 23:38:04,159 - celery.redirected - WARNING - 
During handling of the above exception, another exception occurred:
2025-03-19 23:38:04,160 - celery.redirected - WARNING - Traceback (most recent call last):
2025-03-19 23:38:04,161 - celery.redirected - WARNING -   File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
2025-03-19 23:38:04,163 - celery.redirected - WARNING - OSError: [WinError 233] No process is on the other end of the pipe
2025-03-19 23:38:04,165 - celery.redirected - WARNING - Call stack:
2025-03-19 23:38:04,167 - celery.redirected - WARNING -   File "<frozen runpy>", line 198, in _run_module_as_main
2025-03-19 23:38:04,169 - celery.redirected - WARNING -   File "<frozen runpy>", line 88, in _run_code
2025-03-19 23:38:04,170 - celery.redirected - WARNING -   File "D:\Програмування\FastAPI\discounts\.venv\Scripts\celery.exe\__main__.py", line 7, in <module>
    sys.exit(main())
2025-03-19 23:38:04,171 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\__main__.py", line 15, in main
    sys.exit(_main())
2025-03-19 23:38:04,173 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bin\celery.py", line 236, in main
    return celery(auto_envvar_prefix="CELERY")
2025-03-19 23:38:04,174 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1161, in __call__
    return self.main(*args, **kwargs)
2025-03-19 23:38:04,175 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1082, in main
    rv = self.invoke(ctx)
2025-03-19 23:38:04,179 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1697, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
2025-03-19 23:38:04,181 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 1443, in invoke
    return ctx.invoke(self.callback, **ctx.params)
2025-03-19 23:38:04,184 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\core.py", line 788, in invoke
    return __callback(*args, **kwargs)
2025-03-19 23:38:04,186 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\click\decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
2025-03-19 23:38:04,187 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
2025-03-19 23:38:04,190 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
2025-03-19 23:38:04,191 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 209, in start
    self.stop(exitcode=exc.code)
2025-03-19 23:38:04,193 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 250, in stop
    self._shutdown(warm=True)
2025-03-19 23:38:04,194 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 265, in _shutdown
    self.blueprint.stop(self, terminate=not warm)
2025-03-19 23:38:04,195 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 174, in stop
    self.on_stopped()
2025-03-19 23:38:04,197 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\worker.py", line 161, in on_stopped
    self.consumer.shutdown()
2025-03-19 23:38:04,198 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 415, in shutdown
    self.blueprint.shutdown(self)
2025-03-19 23:38:04,200 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\consumer.py", line 177, in shutdown
    self.send_all(parent, 'shutdown')
2025-03-19 23:38:04,201 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\bootsteps.py", line 148, in send_all
    fun(parent, *args)
2025-03-19 23:38:04,203 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\celery\worker\consumer\connection.py", line 29, in shutdown
    ignore_errors(connection, connection.close)
2025-03-19 23:38:04,204 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\common.py", line 323, in ignore_errors
    return fun(*args, **kwargs)
2025-03-19 23:38:04,206 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\connection.py", line 398, in release
    self._close()
2025-03-19 23:38:04,207 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\connection.py", line 364, in _close
    self._do_close_self()
2025-03-19 23:38:04,209 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\connection.py", line 354, in _do_close_self
    self.maybe_close_channel(self._default_channel)
2025-03-19 23:38:04,210 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\connection.py", line 346, in maybe_close_channel
    channel.close()
2025-03-19 23:38:04,212 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\transport\redis.py", line 1092, in close
    self._brpop_read()
2025-03-19 23:38:04,213 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\transport\redis.py", line 979, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
2025-03-19 23:38:04,215 - celery.redirected - WARNING -   File "d:\Програмування\FastAPI\discounts\.venv\Lib\site-packages\kombu\transport\virtual\base.py", line 1014, in _deliver
    logger.warning(W_NO_CONSUMERS, queue)
2025-03-19 23:38:04,216 - celery.redirected - WARNING - Message: 'Requeuing undeliverable message for queue %r: No consumers.'
Arguments: ('celery',)
2025-03-19 23:38:04,006 - kombu.transport.virtual.base - WARNING - Requeuing undeliverable message for queue 'celery': No consumers.
